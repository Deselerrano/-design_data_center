# Топологии сети

## 1 - Традиционная трехуровневая архитектура

Вы можете использовать иерархическую модель для разработки модульной топологии с использованием масштабируемых «строительных блоков», которые позволяют сети удовлетворять меняющиеся потребности бизнеса. Модульная конструкция упрощает масштабирование, понимание и устранение неполадок сети, обеспечивая детерминированные модели трафика.

В 1999 году компания Cisco представила модель иерархического проектирования, в которой используется многоуровневый подход к проектированию сети. Компонентами строительных блоков являются уровень доступа, уровень агрегации и уровень ядра.

![alt text](https://github.com/Deselerrano/-design_data_center/blob/main/lecuture/traditional_3_tier_topology.png?raw=true)

### Подробнее про уровни:

#### Уровень ядра

В типичной иерархической модели отдельные строительные блоки связаны между собой с помощью уровня ядра. Ядро должно быть быстрым и чрезвычайно отказоустойчивым, поскольку от него зависит возможность подключения каждого строительного блока. Современные системы с аппаратным ускорением способны предоставлять сложные услуги на скорости передачи данных. Однако в основе сети следует использовать подход «лучше меньше, да лучше». Минимальная конфигурация ядра снижает сложность конфигурации, ограничивая возможность эксплуатационных ошибок.

Несмотря на то, что можно достичь избыточности с помощью полностью- или сильно-связанной топологии, этот тип конструкции не обеспечивает последовательную конвергенцию в случае сбоя канала или узла. Кроме того, в полностью взаимосвязанной конструкции существуют проблемы пиринга и смежности, что затрудняет настройку и масштабирование маршрутизации. Кроме того, большое количество портов увеличивает ненужные затраты и сложность по мере роста или изменения сети. Ниже приведены некоторые другие ключевые вопросы проектирования, которые следует учитывать:

- Спроектируйте базовый уровень как высокоскоростную коммутационную среду уровня 3 (L3), использующую только услуги с аппаратным ускорением. Конструкции ядра уровня 3 превосходят конструкции уровня 2 и других альтернатив, поскольку они обеспечивают:

	- Более быструю конвергенцию при сбое канала или узла.

	- Повышенную масштабируемость за счет уменьшения связей между соседями и создания сетки.

	- Более эффективное использование полосы пропускания.

- По возможности используйте резервные двухточечные соединения L3 в ядре (треугольники, а не квадраты), поскольку такая конструкция обеспечивает самые быстрые и наиболее детерминированные результаты сходимости.

- Избегайте петель L2 и сложности избыточности L2, такой как протокол связующего дерева (STP) и косвенное обнаружение сбоев для одноранговых структурных блоков L3.


 
#### Уровень агрегации

Уровень распределения объединяет узлы уровня доступа, защищая ядро ​​от пиринга высокой плотности. Кроме того, уровень распределения создает границу сбоя, обеспечивая точку логической изоляции в случае сбоя, возникшего на уровне доступа. Обычно развертываемый в виде пары коммутаторов L3, уровень распределения использует коммутацию L3 для подключения к ядру сети и услуги L2 для подключения к уровню доступа. Балансировка нагрузки, качество обслуживания (QoS) и простота предоставления являются ключевыми факторами для уровня распределения.

Высокая доступность на уровне распределения обеспечивается посредством двойных путей равной стоимости от уровня распределения к ядру и от уровня доступа к уровню распределения. Это приводит к быстрой детерминированной сходимости в случае сбоя канала или узла. При наличии резервных путей аварийное переключение зависит в первую очередь от обнаружения сбоя аппаратного канала, а не от обнаружения сбоя программного обеспечения на основе таймера. Конвергенция на основе этих функций, реализованных аппаратно, является наиболее детерминированной.

Распределение нагрузки с равной стоимостью L3 позволяет использовать оба восходящих канала от ядра до уровня распределения. Уровень распределения обеспечивает резервирование шлюза по умолчанию с использованием протокола балансировки нагрузки шлюза (GLBP), протокола маршрутизатора горячего резерва (HSRP) или протокола резервирования виртуального маршрутизатора (VRRP). Это позволяет выйти из строя или удалить один из узлов распределения, не влияя на подключение конечной точки к шлюзу по умолчанию.

Добиться балансировки нагрузки на восходящих каналах от уровня доступа к уровню распределения можно разными способами, но самый простой способ — использовать GLBP. GLBP обеспечивает избыточность и защиту от сбоев, подобные HSRP. Это также позволяет осуществлять циклическое распределение шлюзов по умолчанию для доступа к устройствам уровня, поэтому конечные точки могут отправлять трафик на один из двух узлов распределения.

#### Уровень доступа

Уровень доступа — это первая точка входа в сеть для периферийных устройств, конечных станций и IP-телефонов. Коммутаторы уровня доступа подключены к двум отдельным коммутаторам уровня распределения для обеспечения резервирования. Если соединение между коммутаторами уровня распределения является соединением L3, то петель нет, и все восходящие каналы активно пересылают трафик.

Надежный уровень доступа обеспечивает следующие ключевые функции:

• Высокая доступность (HA), поддерживаемая многими атрибутами аппаратного и программного обеспечения.

• Встроенное питание (POE) для IP-телефонии и точек беспроводного доступа, позволяющее клиентам конвергировать голосовую связь в сети передачи данных и обеспечивая пользователям доступ к WLAN в роуминге.


Аппаратные и программные атрибуты уровня доступа, поддерживающие высокую доступность, включают следующее:

• Резервирование на уровне системы с использованием резервных модулей управления и резервных источников питания. Это обеспечивает высокую доступность для критически важных групп пользователей.

• Резервирование шлюза по умолчанию с использованием двойных подключений к резервным системам (коммутаторам уровня распределения), использующим GLBP, HSRP или VRRP. Это обеспечивает быстрое переключение при сбое с одного коммутатора на резервный коммутатор на уровне распределения.

• Функции обеспечения высокой доступности операционной системы, такие как агрегирование каналов (EtherChannel или 802.3ad), которые обеспечивают более высокую эффективную пропускную способность при одновременном снижении сложности.

• Приоритизация критически важного сетевого трафика с использованием QoS. Это обеспечивает классификацию трафика и постановку в очередь как можно ближе к входу в сеть.

• Услуги безопасности для дополнительной защиты от несанкционированного доступа к сети за счет использования таких инструментов, как 802.1x, безопасность портов, отслеживание DHCP, динамическая проверка ARP и IP Source Guard.

• Эффективное управление сетью и пропускной способностью с помощью таких программных функций, как отслеживание протокола членства в группах Интернета (IGMP). Отслеживание IGMP помогает контролировать лавинную рассылку пакетов многоадресной рассылки для приложений многоадресной рассылки.

##### Уровень конечных устройств

На данном уровне находятся ваши сервера)

![alt text](https://github.com/Deselerrano/-design_data_center/blob/main/lecuture/traditional_3_tier_topology_2.png?raw=true)
￼
### Плюсы
- Простая и знакомая
- STP, LACP, MLAG, UDLDP, VPC
- Низкие расходы на коммутацию
- Адаптировано под North-Sorth

### Минусы
- Неоптимальный расход при East-West
- Флуд из-за unknown unicast
- Риски возникновения петель
- Нехватка VLAN (4094)
- Проведение работ на узлах выше Accsess
- Проблемы с резервированием
- Проблемы с масштабированием полосы

## 2 - Нужды и требования текущих ЦОД
￼
Быстрее всего растут ЦОДы и их количество, тенденция к облачным технологиям активно влияе на этот рост

#### Основное направление трафика East-West

На 2014 год:

- “East-West” direction (76%),
- “North-South” traffic (17%),
- inter-DC traffic, 7%

На 2019 год:

- “East-West” direction (73%),
- “North-South” traffic (18%),
- inter-DC traffic, 9%

#### Возможность быстрого масштабирования

- Если вам нужно добавить 10 или 1000 серверов, это не должно быть проблемой
- Аналогично и с расширением полосы, вы должны иметь возможность это сделать легко
- Хорошо, если ЦОД сможет расти также быстро и «непренужденно» как и ваш бизнес

#### Высокая отказоустойчивость

На текущие момент, основные «игроки» на которых можно равняться, стремятся к SLA 99.999* (AWS, Google, Azure)
￼
Но не забываем про цену Возможность проведения работ без вреда для сервисов

Современная модель построения сетей ЦОД, CLOS
￼
￼
Exit - borderleaf
+ ToR
￼
ECMP! per packets (RR)/per flow (IP hash)
5 tuple лучшая балансировка (L3 +L4)  src/dst ip, src/dst port, proto
ЦОД соединяются DCI
ToR
￼
+ infiniband
￼
+ Альтернативные топологии JellyFish
￼
￼
￼
Еще есть вот такие
￼
